<!DOCTYPE html>
<html>

<head>

<meta charset="utf-8">
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<meta name="viewport" content="width=device-width, height=device-height, maximum-scale=1, user-scalable=no" />
<meta name="apple-mobile-web-app-capable" content="yes" />

<!-- definition of the user interface and blocks -->
<script type="application/json" id="ui.json">
{
	"blocks": null,
	"buttons": null,
	"widgets": null,

	"css": [
		"classic.css"
	],

	"fragments": {
		"about.html": "<iframe src=\"vpl-about.html\" style=\"width:100%;height:100%;border:none;\"></iframe>",
		"vpl-export-html.css": "td.events, td.then, td.actions {\n\tborder: solid 2px silver;\n\tborder-style: solid none;\n}\ntd.block {\n\tpadding: 15px;\n}\ntd.events {\n    min-width: 20px;\n    border-left-style: solid;\n    border-top-left-radius: 20px; \n    border-bottom-left-radius: 20px;\n}\ntd.event-aux {    transform: scale(0.8) translate(0,10px);\n}\ntd.actions {\n    min-width: 20px;\n    border-right-style: solid;\n    border-bottom-right-radius: 20px; \n    border-top-right-radius: 20px; \n}\ntable.program {\n\tborder-collapse: separate;\n\tborder-spacing: 0 10px;\n\tmargin-left: auto;\n\tmargin-right: auto;\n}\n"
	},

	"overlays": [
		"block-english.json",
		"cmd-vpl-english.json",
		"french.json",
		"block-french.json",
		"cmd-vpl-french.json"
	]
}
</script>

<script type="text/x-vpl-css" id="classic.css">
/*
	CSS for VPL3 application
    Classic version (blocks, buttons and widgets defined in JavaScript)
	Copyright 2019, ECOLE POLYTECHNIQUE FEDERALE DE LAUSANNE
*/

view {
	background: white;
}

toolbar {
	padding: 5px;
	margin: 0;
}

button {
	width: 3.0ww;
	height: 3.0ww;
	min-width: 20px;
	min-height: 20px;
	margin: 0.2vw;
}

#vpl-close, #src-close, #sim-close {
	width: 1.5ww;
	min-width: 10px;
}

button.vpl.bottom {
	font: 1.7vw sans-serif;
}

#vpl-message-error {
	color: #e44;
	width: 20vw;
}

#vpl-message-warning {
	color: #f88;
	width: 20vw;
}

#vpl-filename {
	width: 9ww;
	font: 1vw sans-serif;
}

separator {
	width: 5px;
	height: 5px;
}

vpl {
	padding: 5px;
	margin: 5px;
	background: #eee;
}

block {
	width: 6vw;
	height: 6vw;
	min-width: 32px;
	min-height: 32px;
}

block.library {
	margin: 4px;
}

block.event {
	background: #f70;
	border: none #f70;
}
block.event-aux, block.state {
	width: 5vw;
	height: 5vw;
	min-width: 27px;
	min-height: 27px;
	vertical-align: bottom;
}
block.action {
	background: #38f;
	border: none #38f;
}
block.state {
	background: #0c0;
	border: none #0c0;
}
block.comment {
	background: #aaa;
	border: none #aaa;
}
block.empty {
	border-width: 2px;
	background: transparent;
	width: 1.5vw;
	min-width: 8px;
}
block.empty.event-aux {
	height: 5vw;
	min-height: 27px;
	vertical-align: bottom;
}
block.empty:only-child {
	width: 6vw;
	min-width: 32px;
}

block-container {
	padding: 0;
	padding-bottom: 0.4vw;
	margin: 0.6vw;
	margin-bottom: 0.2vw;
	border-bottom: transparent 3px;
}

block-container.error {
	border-bottom: #e44 3px;
}
block-container.warning {
	border-bottom: #f88 3px;
}

rule {
	background: #ddd;
	border: solid #666;
	border-radius: 0.6vw;
	padding: 0.3vw;
	margin:0.6vw;
}

rule:small {
	background: white;
}

overlay-rectangle.disabled {
	background: rgba(255,255,255,0.5);
}

overlay-rectangle.drop-target {
	border: 0.2vw rgba(0,0,0,0.5);
	border-radius: 0.2vw;
}

crossout-line {
	line-width: 0.75vw;
 	color: rgba(120,120,120,0.5);
}
crossout-line.vpl {
	line-width: 5vw;
}

#widget-error, #widget-warning {
	width: 3vw;
	height: 3vw;
	padding: 0.2vw;
	margin-right: 0.8vw;
}

conflict-line.error {
	line: 3px #e44 dashed;
}
conflict-line.warning {
	line: 3px #f88;
}

#widget-then {
	width: 3vw;
	height: 3vw;
	padding: 1vw;
}

block-library {
	padding: 5px;
	padding-top: 0;
}

block.library {
	width: 4vw;
	height: 4vw;
	min-width: 32px;
	min-height: 32px;
}

hint {
	font: 1vw sans-serif;
	padding: 0.5vw;
	background-color: white;
	color: #222;
}

/* simulator */

sim-controller {
	background: #eee;
	margin: 5px;
	padding: 1vw;
}

button.event {
	width: 2vw;
	height: 2vw;
	margin: 0.2vw;
}

sim-playground-area {
	background: #eee;
	margin: 5px;
	padding: 5px;
}

sim-playground {
	border: 2px silver;
}
</script>

<script type="text/x-vpl-css" id="french.json">
{
	"i18n": {
		"fr": {
			"Duplicate action blocks": "Un bloc d'action fait doublon",
			"Rules with same events": "Règles avec les mêmes événements",
			"Missing action block": "Il manque un bloc d'action",
			"Missing event block": "Il manque un bloc d'événement",
			"No button specified": "Aucun bouton n'est spécifié",
			"No ground sensor specified": "Aucun capteur de sol n'est spécifié",
			"No proximity sensor specified": "Aucun capteur de proximité n'est spécifié",
			"No sensor specified": "Aucun capteur n'est spécifié"
		}
	}
}
</script>

<script type="text/x-vpl-css" id="block-english.json">
{
	"i18n": {
		"en": {
			"button 1": "Single button",
			"button": "Multiple buttons",
			"horiz prox": "Proximity sensors",
			"horiz prox adv": "Proximity sensors with low and high thresholds",
			"horiz prox 1": "Proximity sensors with threshold",
			"ground": "Ground reflection sensors",
			"ground adv": "Ground reflection sensors with low and high sensors",
			"ground 1": "Ground reflection sensors with threshold",
			"tap": "Impact detection",
			"accelerometer": "Accelerometer",
			"roll": "Roll angle",
			"pitch": "Pitch angle",
			"yaw": "Yaw angle",
			"clap": "Sound detection",
			"init": "Initialization",
			"timer": "Timer elapsed",
			"state": "State (4 bits)",
			"state 8": "State (8 values)",
			"counter comparison": "Counter comparison",
			"color state": "Color state",
			"color 8 state": "Color state",
			"motor state": "Motor state",
			"motor": "Set motor speeds",
			"move": "Set motion",
			"top color": "Set top color (RGB components)",
			"top color 8": "Set top color",
			"bottom color": "Set bottom color (RGB components)",
			"bottom-left color": "Set bottom-left color (RGB components)",
			"bottom-right color": "Set bottom-right color (RGB components)",
			"bottom color 8": "Set bottom color",
			"bottom-left color 8": "Set bottom-left color",
			"bottom-right color 8": "Set bottom-right color",
			"notes": "Play melody",
			"set state": "Set state (4 bits)",
			"toggle state": "Toggle state (4 bits)",
			"set state 8": "Set state (8 values)",
			"change state 8": "Set to next or previous state (8 values)",
			"set counter": "Set counter",
			"set timer": "Start timer (0-4 sec)",
			"set timer log": "Set timer (0.1-10 sec)",
			"picture comment": "Picture comment"
		}
	}
}
</script>

<script type="text/x-vpl-css" id="cmd-vpl-english.json">
{
	"i18n": {
		"en": {
			"vpl:close": "Close panel",
			"vpl:about": "Show application information",
			"vpl:help": "Show documentation",
			"vpl:readonly": "Read-only program",
			"vpl:new": "New program",
			"vpl:save": "Save program",
			"vpl:load": "Load program",
			"vpl:upload": "Upload program",
			"vpl:exportToHTML": "Export program view to HTML",
			"vpl:text": "Text source code panel",
			"vpl:text-toggle": "Show or hide text source code panel",
			"vpl:advanced": "Switch advanced mode on or off",
			"vpl:undo": "Undo last program change",
			"vpl:redo": "Redo last undone program change",
			"vpl:run": "Run program",
			"vpl:stop": "Stop program",
			"vpl:connected": "Connection status",
			"vpl:robot": "Change robot",
			"vpl:sim": "Simulator panel",
			"vpl:duplicate": "Duplicate rule (rule drop target)",
			"vpl:disable": "Disable block or rule (drop target)",
			"vpl:lock": "Lock block or rule (drop target)",
			"vpl:trashcan": "Remove block or rule (drop target)",
			"vpl:message-error": "Error message",
			"vpl:message-warning": "Warning message",
			"vpl:message-empty": " ",
			"vpl:filename": "Filename",
			"vpl:teacher": "Switch customization mode on or off",
			"vpl:teacher-reset": "Reset customization",
			"vpl:teacher-save": "Save customization",
			"vpl:teacher-setasnew": "Install customization for new programs"
		}
	}
}
</script>

<script type="text/x-vpl-css" id="block-french.json">
{
	"i18n": {
		"fr": {
			"button 1": "Bouton simple",
			"button": "Boutons multiples",
			"horiz prox": "Capteurs de proximité",
			"horiz prox adv": "Capteurs de proximité avec seuils bas et haut",
			"horiz prox 1": "Capteurs de proximité avec seuil",
			"ground": "Capteurs de réflexion sur le sol",
			"ground adv": "Capteurs de réflexion sur le sol avec seuils bas et haut",
			"ground 1": "Capteurs de réflexion sur le sol avec seuil",
			"tap": "Détection de choc",
			"accelerometer": "Accéléromètre",
			"roll": "Angle de roulis",
			"pitch": "Angle de tangage",
			"yaw": "Angle de lacet",
			"clap": "Détection de son",
			"init": "Initialisation",
			"timer": "Minuterie",
			"state": "État (4 bits)",
			"state 8": "État (8 valeurs)",
			"counter comparison": "Comparaison du compteur",
			"color state": "État (couleur)",
			"color 8 state": "État (couleur)",
			"motor state": "Vitesses des moteurs",
			"motor": "Change les vitesses des moteurs",
			"move": "Change le type de déplacement",
			"top color": "Change la couleur du dessus (composantes RVB)",
			"top color 8": "Change la couleur du dessus",
			"bottom color": "Change la couleur du dessous (composantes RVB)",
			"bottom-left color": "Change la couleur du dessous à gauche (composantes RVB)",
			"bottom-right color": "Change la couleur du dessous à droite (composantes RVB)",
			"bottom color 8": "Change la couleur du dessous",
			"bottom-left color 8": "Change la couleur du dessous à gauche",
			"bottom-right color 8": "Change la couleur du dessous à droite",
			"notes": "Joue une mélodie",
			"set state": "Change l'état (4 bits)",
			"toggle state": "Inverse l'état (4 bits)",
			"set state 8": "Change l'état (8 valeurs)",
			"change state 8": "Passe à l'état suivant ou précédant (8 valeurs)",
			"set counter": "Change le compteur",
			"set timer": "Démarre la minuterie (0-4 sec)",
			"set timer log": "Démarre la minuterie (0.1-10 sec)",
			"picture comment": "Commentaire (image)"
		}
	}
}
</script>

<script type="text/x-vpl-css" id="cmd-vpl-french.json">
{
	"i18n": {
		"fr": {
			"vpl:close": "Ferme la vue",
			"vpl:about": "Affiche des informations sur l'application",
			"vpl:help": "Affiche la documentation",
			"vpl:readonly": "Programme en mode lecture seule",
			"vpl:new": "Nouveau programme",
			"vpl:save": "Enregistre le programme",
			"vpl:load": "Charge le programme",
			"vpl:upload": "Téléverse le programme",
			"vpl:exportToHTML": "Exporte le programme en HTML",
			"vpl:text": "Affiche le code source",
			"vpl:text-toggle": "Affiche ou cache la vue code source",
			"vpl:advanced": "Commute entre les modes de base et avancés",
			"vpl:undo": "Annule le dernier changement",
			"vpl:redo": "Rétablit le dernier changement annulé",
			"vpl:run": "Exécute le programme",
			"vpl:stop": "Arrête le programme",
			"vpl:connected": "Témoin de connexion",
			"vpl:robot": "Change de robot",
			"vpl:sim": "Affiche le simulateur",
			"vpl:duplicate": "Duplique une règle (cible de glisser/déposer)",
			"vpl:disable": "Désactive un bloc ou une règle (cible de glisser/déposer)",
			"vpl:lock": "Verrouille un bloc ou une règle (cible de glisser/déposer)",
			"vpl:trashcan": "Supprime un bloc ou une règle (cible de glisser/déposer)",
			"vpl:message-error": "Message d'erreur",
			"vpl:message-warning": "Message d'avertissement",
			"vpl:message-empty": " ",
			"vpl:filename": "Nom de fichier",
			"vpl:teacher": "Commute entre les modes de programmation et de configuration",
			"vpl:teacher-reset": "Remet la configuration à l'état d'origine",
			"vpl:teacher-save": "Enregistre la configuration",
			"vpl:teacher-setasnew": "Installe la configuration pour les nouveaux programmes"
		}
	}
}
</script>

<title>VPL</title>

<style>
html {
	height: 100%;
}
body {
	height: 100%;
	margin: 0;
}
#programCanvas {
	width: 100%;
	height: 100%;
	display: block;
	z-index: 10;
}
#src-editor {
	width: 100%;
	position: fixed;
	z-index: 20;
}
#editor {
	height: 100%;
	display: block;
	padding-top: 0;
	padding-bottom: 0;
	padding-left: 5pt;
	padding-right: 5pt;
	margin: 0;
	border: 0;
	box-sizing: border-box;
	tab-size: 4;
	font-family: monospace;
	font-size: 11pt;
}
pre#editor-lines {
	background-color: silver;
    width: 70px;
    float: left;
    margin: 0;
    padding-top: 0;
    padding-bottom: 0;
    padding-left: 0;
    padding-right: 5pt;
    text-align: right;
    overflow: hidden;
	user-select: none;
}

#input {
	position: absolute;
	z-index: 1000;
	font-family: sans-serif;
	font-size: 15pt;
	top: 10px;
	left: 10px;
	display: none;
}

@media only screen and (max-device-width: 1024px) {
	#editor {
		tab-size: 2;
		font-size: 10pt;
	}
}
</style>

<script src="src/a3a-ns.js"></script>
<script src="src/svg.js"></script>
<script src="src/svg-preparsed.js"></script>
<script src="src/svg-transform.js"></script>
<script src="src/vpl-ns.js"></script>
<script src="src/vpl-blocktemplate.js"></script>
<script src="src/vpl-block.js"></script>
<script src="src/vpl-emptyblock.js"></script>
<script src="src/css.js"></script>
<script src="src/vpl-css.js"></script>
<script src="src/vpl-css-draw.js"></script>
<script src="src/vpl-canvas.js"></script>
<script src="src/vpl-canvas-scroll.js"></script>
<script src="src/vpl-blocklibutil.js"></script>
<script src="src/vpl-blocklib.js"></script>
<script src="src/vpl-blocklib-svg.js"></script>
<script src="src/vpl-blocklib-l2.js"></script>
<script src="src/vpl-blocklib-js.js"></script>
<script src="src/vpl-blocklib-python.js"></script>
<script src="src/vpl-jsoncode.js"></script>
<script src="src/vpl-rule.js"></script>
<script src="src/vpl-uiconfig.js"></script>
<script src="src/vpl-program.js"></script>
<script src="src/vpl-code.js"></script>
<script src="src/vpl-code-aseba.js"></script>
<script src="src/vpl-code-l2.js"></script>
<script src="src/vpl-code-js.js"></script>
<script src="src/vpl-code-python.js"></script>
<script src="src/vpl-cmd.js"></script>
<script src="src/vpl-app.js"></script>
<script src="src/vpl-ui-validator.js"></script>
<script src="src/vpl-cmd-vpl.js"></script>
<script src="src/vpl-controlbar.js"></script>
<script src="src/vpl-buttons-js.js"></script>
<script src="src/vpl-controlbar-btn.js"></script>
<script src="src/vpl-widgets-js.js"></script>
<script src="src/vpl-program-canvas.js"></script>
<script src="src/vpl-error.js"></script>
<script src="src/vpl-draw.js"></script>
<script src="src/vpl-undo.js"></script>
<script src="src/vpl-html.js"></script>
<script src="src/vpl-aeslfile.js"></script>
<script src="src/vpl-texteditor.js"></script>
<script src="src/vpl-sourceedit.js"></script>
<script src="src/vpl-cmd-src.js"></script>
<script src="src/vpl-ui-svg.js"></script>
<script src="src/vpl-runglue.js"></script>
<script src="src/vpl-htmlpanel.js"></script>
<script src="src/vpl-files.js"></script>
<script src="src/vpl-load.js"></script>
<script src="src/vpl-com.js"></script>
<script src="src/vpl-i18n.js"></script>
<script src="src/vpl-main.js"></script>

<script src="src/a3a-nodebase.js"></script>
<script src="src/a3a-nodeproxy.js"></script>

<script src="src/vpl-thymio.js"></script>
<script src="src/vpl-thymio-tdm.js"></script>
<script src="src/vpl-robot.js"></script>
<script src="src/vpl-virtualthymio.js"></script>
<script src="src/compiler-ns.js"></script>
<script src="src/compiler-vm.js"></script>
<script src="src/compiler-dis.js"></script>
<script src="src/compiler.js"></script>
<script src="src/compiler-macros.js"></script>
<script src="src/compiler-l2.js"></script>
<script src="src/compiler-macros-l2.js"></script>
<script src="src/compiler-thymio.js"></script>
<script src="src/inputbuffer.js"></script>
<script src="src/a3a-idmapping.js"></script>
<script src="src/a3a-com.js"></script>
<script src="src/a3a-device.js"></script>
<script src="src/a3a-virtual-thymio.js"></script>
<script src="src/vpl-virtualthymio-a3a.js"></script>
<script src="src/vpl-obstacles.js"></script>
<script src="src/vpl-sim.js"></script>
<script src="src/vpl-sim2d.js"></script>
<script src="src/vpl-cmd-sim.js"></script>

<script src="thymio/thymio.js"></script>

</head>

<body>

<div id="vpl-editor">

<canvas id="programCanvas" width="900" height="700"></canvas>

<input id="input">

</div>

<div id="src-editor">
<pre id="editor-lines"></pre>
<textarea id="editor" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
</textarea>
</div>

</body>

</html>
