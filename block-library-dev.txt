Block library development
-------------------------

Blocks are defined in a script element with id "ui.json" in index-svg.html. The syntax of the script element is JSON. The appearance of blocks is defined by SVG elements specified by URI strings with syntax "filename#id", where "filename" is the id of a script element in index-svg.html which contains a complete svg file, and "id" is the svg element id in that file.

Here are fragments of index-svg.html which illustrate the definition of the block "button". Property "main" contains the URI of the svg element which is drawn for the button block. The filename part, "blocks.svg", refers to the script element which contains the svg the element belongs to; and the id part, "Ev_Buttons", is the element id in that svg.

<script type="application/json" id="ui.json">
...
"blocks": [
	...
	{
		"name": "button",
		"main": "blocks.svg#Ev_Buttons"
	}
	...
]
...
</script>

<script type="image/svg+xml" id="blocks.svg">
...
<g id="Ev_Buttons">
...
</g>
...
</script>

In json, block contain the following properties:

- "name" (string, required): the block name, which should match VPL1 if possible.

- "type" (string, required): one of "event", "state", "action", or "comment", which defines where the block is displayed (left for "event" or "state", right for "action" or "comment") and how it is used.

- "modes" (array of strings, possibly empty, required): in which VPL mode the block is displayed. Contains "basic" if displayed in basic mode, "advanced" if displayed in advanced mode. This defines only the default block usage; customization can override it.

- "background" (array of objects, possibly empty, required): list of fixed parts defining the block appearance. Each part is described by an object with the following properties:

	- "uri" (string, required): uri of the svg element
	- "scale" (number, optional, default: 1): scale at which the element is displayed
	- "dx" (number, optional, default: 0): horizontal displacement
	- "dy" (number, optional, default: 0): vertical displacement

- "main" (array of objects, at least one element, required): list of the parts defining the block appearance including buttons, sliders, etc.

- "defaultParameters" (array of number, boolean or string values, optional): default values of the block parameters which define the state, in this order, of buttons (one value per button), radiobuttons (a single values for all radiobuttons), sliders (one value per slider), rotating controls (one value per control).

- "buttons" (array of objects, optional): button definitions. Each button is described by an object with the following properties:

	- "id" (string, required): id of the svg element corresponding to the button. It should be contained in the element identified by "main".
	- "val" (array of numbers, booleans or strings, required): possible values for the button state. Each click toggles to the next value.
 	- "st" (array of strings): style strings applied to svg elements when the corresponding value in val is active. Each style is defined by a fill and/or a stroke color, with the syntax "fill:color;stroke:color", or fill/stroke swapped, or one of them skipped without semicolon.

- "radiobuttons" (array of objects, optional): radio button definitions (exclusive buttons). Each button is described by an object with the following properties:

	- "id" (string, required): id of the svg element corresponding to the button. It should be contained in the element identified by "main".
	- "val" (number, boolean or string, required): value for the set of radio buttons.
 	- "st" (array of strings): style strings applied to svg elements when the corresponding value in val is active. Each style is defined by a fill and/or a stroke color, with the syntax "fill:color;stroke:color", or fill/stroke swapped, or one of them skipped without semicolon.

- "sliders" (array of objects, optional): slider definitions. Each slider is described by an object with the following properties:

	- "id" (string, required): id of the svg element corresponding to the slider, including the thumb. If the element's height is larger than the element's width, the slider is vertical, else it's horizontal.
	- "thumbId" (string, required): id of the svg element corresponding to the thumb in the slider (the part which can be moved).
	- "min" (number, required): minimum value, stored in the block parameters.	- "max" (number, required): maximum value, stored in the block parameters.

- "rotating" (array of objects, optional): rotating control definitions. Each control is described by an object with the following properties:

	- "id" (string, required): id of the svg element corresponding to the slider, including the thumb. If the element's height is larger than the element's width, the slider is vertical, else it's horizontal.
	- "centerId" (string, required): id of the svg element whose center is the center of rotation.
	- "thumbId" (string, required): id of the svg element corresponding to the control part which can be moved.
